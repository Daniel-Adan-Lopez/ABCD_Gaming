#hurdle models
library(brms)
library(bayesplot)

###
# 
#everything below is just the models used to get the results shown in Table 3, Table 4, Table 5, Table 6, Table S4, Table S5
#Video Game Addiction Questionnaire (VGAQ)
#certain continuous variables are scaled to improve model run time
#Estimates are shown for the zero component and hurdle parts of the model. 

#the dataset only includes data from the year-2 ABCD visit.
#parallel processing was used to improve model run time. 

#plots were created using the conditional_effects function in BRMS and the bayesplot package
###############

#model building was done using the loo function in BRMS. Model building is not shown here.

########

summary(model_NACC_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                      hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh     -0.0167    0.0325  -0.0796   0.0491 1.0021     5843     2772
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh  -0.0003    0.1409  -0.2743   0.2852 1.0006     3857     3154
print(model_NACC_VG_hurdle_1, digits=4)
save(model_NACC_VG_hurdle_1, file = "model_NACC_VG_hurdle_1.rda")
######

#######

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh
print(model_NACC_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                    hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh     -0.0009    0.0328  -0.0660   0.0645 1.0007     4904     2767
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.0046    0.1412  -0.2728   0.2842 1.0013     3836     2860
save(model_NACC_VG_brms2, file = "model_NACC_VG_brms2.rda")

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh
print(model_NACC_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                    hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh      0.0729    0.0309   0.0118   0.1340 1.0002     6617     2970
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.0998    0.1287  -0.1491   0.3555 1.0008     4490     2936

save(model_NACC_VG_brms3, file = "model_NACC_VG_brms3.rda")

#########


#######
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh
print(model_NACC_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh      0.0593    0.0316  -0.0033   0.1220 1.0004     5807     3018
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.0770    0.1420  -0.2040   0.3522 1.0016     3419     2763
save(model_NACC_VG_brms4, file = "model_NACC_VG_brms4.rda")

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh
print(model_NACC_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh      0.0044    0.0308  -0.0548   0.0648 1.0025     5032     2668
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.1787    0.1326  -0.0814   0.4471 1.0013     3146     2528
save(model_NACC_VG_brms5 , file = "model_NACC_VG_brms5 .rda")
load("model_NACC_VG_brms5 .rda")
conditional_effects(model_NACC_VG_brms5 )

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh
print(model_NACC_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh      0.0094    0.0300  -0.0473   0.0673 1.0018     5682     3129
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.3703    0.1345   0.1230   0.6393 1.0023     2171     2753
save(model_NACC_VG_brms6, file = "model_NACC_VG_brms6.rda")
load("model_NACC_VG_brms6.rda")
 
#####

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh
print(model_NACC_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh     -0.0813    0.0342  -0.1487  -0.0153 1.0009     4871     2854
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh   0.0350    0.1434  -0.2460   0.3153 1.0017     3411     2644
save(model_NACC_VG_brms7, file = "model_NACC_VG_brms7.rda")
load("model_NACC_VG_brms7.rda")
 

#######
 
######


#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh

print(model_NACC_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh     -0.0259    0.0357  -0.0967   0.0435 0.9998     6168     2578
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.1147    0.1410  -0.1626   0.3988 1.0004     3939     3103
save(model_NACC_VG_brms8, file = "model_NACC_VG_brms8.rda")
#####
#VMPFC

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x

print(model_VMPFC_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0091    0.0232  -0.0558   0.0360 1.0020     5158     2958
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x  -0.0399    0.1003  -0.2395   0.1519 1.0002     4225     2588
save(model_VMPFC_VG_brms1, file = "model_VMPFC_VG_brms1.rda")

##tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x
print(model_VMPFC_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0134    0.0251  -0.0634   0.0350 1.0020     5741     2818
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0186    0.0996  -0.1749   0.2185 1.0007     3942     3064
save(model_VMPFC_VG_brms2, file = "model_VMPFC_VG_brms2.rda")

###########
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y
print(model_VMPFC_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y      0.0379    0.0208  -0.0026   0.0787 1.0016     4892     3104
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y   0.1618    0.0862  -0.0016   0.3382 1.0001     3312     2729
save(model_VMPFC_VG_brms3, file = "model_VMPFC_VG_brms3.rda")
load("model_VMPFC_VG_brms3.rda")
 

#######
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y
print(model_VMPFC_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y      0.0309    0.0219  -0.0120   0.0731 1.0016     4170     2640
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y   0.0628    0.0957  -0.1247   0.2541 1.0011     3161     2921
save(model_VMPFC_VG_brms4, file = "model_VMPFC_VG_brms4.rda")



#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x
print(model_VMPFC_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x +(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0075    0.0239  -0.0550   0.0382 1.0009     6466     2901
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x   0.0445    0.0957  -0.1477   0.2307 1.0010     4354     2976
save(model_VMPFC_VG_brms5, file = "model_VMPFC_VG_brms5.rda")

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x
print(model_VMPFC_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x + (1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0130    0.0245  -0.0609   0.0350 1.0001     5581     3248
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0199    0.1000  -0.1743   0.2206 1.0006     4233     3137
save(model_VMPFC_VG_brms6, file = "model_VMPFC_VG_brms6.rda")

# tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x
print(model_VMPFC_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+ (1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x      0.0351    0.0201  -0.0045   0.0737 1.0023     5073     2856
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x   0.0258    0.0843  -0.1349   0.1929 1.0010     3756     2994
save(model_VMPFC_VG_brms7, file = "model_VMPFC_VG_brms7.rda")
library(emmeans)
ame_model_hurdle_1 <- model_VMPFC_VG_hurdle_7 |> 
  emtrends(~ tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x, 
           var = "tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x", epred = TRUE,
           at = list(tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x = seq(0, 1, 1)),
          re_formula=NULL)


#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x
print(model_VMPFC_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                     hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+ (1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x      0.0198    0.0196  -0.0187   0.0588 1.0003    22163     8931
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x   0.0159    0.0894  -0.1528   0.1948 1.0003    16246     8868
save(model_VMPFC_VG_brms8, file = "model_VMPFC_VG_brms8.rda")

#########
#insula

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh
print(model_Insula_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)


#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh     -0.0781    0.0668  -0.2107   0.0522 1.0014     4184     2915
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh  -0.1921    0.3001  -0.7527   0.4173 1.0007     2901     2754
save(model_Insula_VG_hurdle_1, file = "model_Insula_VG_hurdle_1.rda")

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh
print(model_Insula_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh     -0.0443    0.0664  -0.1769   0.0838 1.0012     5063     2760
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh   0.0230    0.2836  -0.5164   0.5876 1.0012     4309     3055

save(model_Insula_VG_hurdle_2, file = "model_Insula_VG_hurdle_2.rda")
#######

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh
print(model_Insula_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh      0.1380    0.0605   0.0191   0.2566 1.0006    22043     7997
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.1968    0.2625  -0.3070   0.7166 1.0001    15801     9144
# 
# print(model_InsulaFreq3_brms <- brm(bf(VGTotal_zero ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
#                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
#                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
#                                        hu ~ 1),
#                                     chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_gamma(), 
#                                     control=list(adapt_delta=0.99), backend="cmdstanr", seed=1234, threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.1218    0.0648  -0.0079   0.2474 1.0007     5207     2655
save(model_Insula_VG_hurdle_3, file = "model_Insula_VG_hurdle_3.rda")
pp_check(model_InsulaFreq3_brms, type="bars", ndraws = 1000)
prop_zero <- function(x) {sum(x == 0)/length(x)}
ppc_stat(y = rd_1$VGTotal_zero, yrep = posterior_predict(model_NACCFreq3_brms_test, draws = 1000), stat="prop_zero")
#######
library(pscl)

mod.hurdle.nb <- hurdle(VGTotal_zero ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh, data = ABCD_GamingYear2_QC, dist = "negbin")
summary(mod.hurdle.nb)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh  0.140740   0.059841   2.352   0.0187 *  
#zero hurdle
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh -0.162968   0.199388  -0.817 0.413733 
library(countreg)
rootogram(mod.hurdle.nb, max = 30) # fit up to count 80

######
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh


print(model_Insula_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh      0.1252    0.0621   0.0052   0.2462 1.0006    26883     7904
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh   0.4663    0.2682  -0.0571   0.9972 1.0002    14759     9135
save(model_Insula_VG_hurdle_4, file = "model_Insula_VG_hurdle_4.rda")




print(model_Insula_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh     -0.1569    0.0707  -0.2943  -0.0165 1.0005    35775     8166
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh  -0.1043    0.3002  -0.7056   0.4766 1.0003    18825    10009
save(model_Insula_VG_hurdle_5, file = "model_Insula_VG_hurdle_5.rda")
load("model_Insula_VG_hurdle_5.rda")
conditional_effects(model_InsulaFreq5_brms)


print(model_Insula_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh     -0.1039    0.0684  -0.2405   0.0253 1.0004     4435     2693
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh   0.0787    0.2814  -0.4734   0.6299 1.0015     2996     2246
save(model_Insula_VG_hurdle_6, file = "model_Insula_VG_hurdle_6.rda")

print(model_Insula_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh     -0.0124    0.0625  -0.1350   0.1116 1.0014     5322     2924
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.0514    0.2602  -0.4644   0.5692 1.0022     3818     2534
save(model_Insula_VG_hurdle_7, file = "model_Insula_VG_hurdle_7.rda")


####

print(model_Insula_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                      hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh     -0.0421    0.0605  -0.1593   0.0761 1.0025     5941     2663
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh   0.2194    0.2566  -0.2755   0.7255 1.0014     3859     3030
save(model_Insula_VG_hurdle_8, file = "model_Insula_VG_hurdle_8.rda")
#####
#DACC

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh

print(model_DACC_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0339    0.0539  -0.1414   0.0729 1.0006     4704     2866
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh   0.2429    0.2358  -0.2019   0.7176 1.0019     2619     2249
save(model_DACC_VG_hurdle_1, file = "model_DACC_VG_hurdle_1.rda")

#tfmri_AnticLargeRewardNeutral_DACC_RH
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh
print(model_DACC_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh      0.0058    0.0567  -0.1052   0.1167 1.0004    28269     8646
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh   0.0662    0.2445  -0.4100   0.5508 1.0001    20197     9021
save(model_DACC_VG_hurdle_2, file = "model_DACC_VG_hurdle_2.rda")

print(model_DACC_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh      0.1192    0.0507   0.0197   0.2174 0.9995     4947     2845
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh   0.3558    0.2181  -0.0662   0.7892 1.0002     3523     3341
save(model_DACC_VG_hurdle_3, file = "model_DACC_VG_hurdle_3.rda")
rm(model_DACCFreq3_brms)
load("model_DACCFreq3_brms.rda")
print(model_DACCFreq3_brms, digits=4)


print(model_DACC_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)


#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh      0.1280    0.0528   0.0300   0.2301 1.0003     5374     2948
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh   0.3292    0.2243  -0.0967   0.7841 1.0006     4728     3390
save(model_DACC_VG_hurdle_4, file = "model_DACC_VG_hurdle_4.rda")

print(model_DACC_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0741    0.0573  -0.1885   0.0391 1.0042     6481     2940
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh  -0.0333    0.2397  -0.4938   0.4338 1.0005     4193     3024
save(model_DACC_VG_hurdle_5, file = "model_DACC_VG_hurdle_5.rda")


print(model_DACC_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0480    0.0607  -0.1664   0.0697 1.0017     5789     2822
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh  -0.1443    0.2516  -0.6348   0.3508 1.0002     3494     2832
save(model_DACC_VG_hurdle_6, file = "model_DACC_VG_hurdle_6.rda")

print(model_DACC_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0443    0.0470  -0.1372   0.0482 1.0001    22195     8609
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh   0.2365    0.2102  -0.1663   0.6651 1.0002    13997     9839
save(model_DACC_VG_hurdle_7, file = "model_DACC_VG_hurdle_7.rda")

print(model_DACC_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)


#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0189    0.0504  -0.1171   0.0782 1.0008     4670     2966
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh   0.2156    0.2250  -0.2147   0.6552 1.0000     3986     2849
save(model_DACC_VG_hurdle_8, file = "model_DACC_VG_hurdle_8.rda")
####
#LOFC
tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh

print(model_LOFC_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0177    0.0325  -0.0805   0.0452 1.0005     4365     3224
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh  -0.0569    0.1498  -0.3584   0.2379 1.0019     3053     2936
save(model_LOFC_VG_hurdle_1, file = "model_LOFC_VG_hurdle_1.rda")


print(model_LOFC_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0139    0.0350  -0.0816   0.0535 0.9994     6776     2731
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.0506    0.1512  -0.2418   0.3499 1.0010     3120     2276


save(model_LOFC_VG_hurdle_2, file = "model_LOFC_VG_hurdle_2.rda")


#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh
print(model_LOFC_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0457    0.0363  -0.1172   0.0268 1.0038     5693     2406
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh  -0.0965    0.1586  -0.4119   0.2142 1.0009     3827     2799
save(model_LOFC_VG_hurdle_3, file = "model_LOFC_VG_hurdle_3.rda")

print(model_LOFC_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0296    0.0371  -0.1013   0.0437 1.0023     5111     2832
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.0192    0.1577  -0.2896   0.3292 1.0020     3230     2027
save(model_LOFC_VG_hurdle_4, file = "model_LOFC_VG_hurdle_4.rda")

print(model_LOFC_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh      0.0702    0.0299   0.0108   0.1287 1.0004    29232     8670
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh   0.0717    0.1271  -0.1769   0.3265 1.0003    20414     9075
save(model_LOFC_VG_hurdle_5, file = "model_LOFC_VG_hurdle_5.rda")

#####
print(model_LOFC_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh      0.0602    0.0319  -0.0023   0.1233 1.0000    16720     9075
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   0.2194    0.1396  -0.0487   0.4983 1.0000    12862     9394
save(model_LOFC_VG_hurdle_6, file = "model_LOFC_VG_hurdle_6.rda")
xx <- loo(model_LOFC_VG_brms6)

########
print(model_LOFC_VG_brms6_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                      zi~
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=2000, family = zero_inflated_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#zi_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   0.3122    0.2441  -0.1484   0.8184 1.0014     2643     3019
yy <- loo(model_LOFC_VG_brms6_1)
loo_compare(yy,xx)
#                       elpd_diff se_diff
# model_LOFC_VG_brms6      0.0       0.0 
# model_LOFC_VG_brms6_1 -195.3      22.2

# print(model_LOFC_VG_brms6_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
#                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
#                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
#                                       zi~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
#                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
#                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
#                                    chains=4, cores=4, warmup=1000, iter=2000, family = zero_inflated_negbinomial(), 
#                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
# #zi_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   2.7533    1.4087   0.4752   6.0485 1.0048      825     1833
pp <- loo(model_LOFC_VG_brms6_2)
pp_check(model_LOFC_VG_brms6_2, type="bars", ndraws = 1000)
prop_zero <- function(x) {sum(x == 0)/length(x)}

loo_compare(yy,xx,pp)




print(model_LOFC_VG_brms6_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                      zi~sex+ neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=2000, family = zero_inflated_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#zi_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   0.4885    0.2700  -0.0092   1.0580 1.0027     1131     1123
qq <- loo(model_LOFC_VG_brms6_4)
loo_compare(yy,xx,pp,qq)
# elpd_diff se_diff
# model_LOFC_VG_brms6_2    0.0       0.0 
# model_LOFC_VG_brms6_4 -179.2       8.6 
# model_LOFC_VG_brms6   -207.6      12.3 
# model_LOFC_VG_brms6_1 -402.9      21.0 

# print(model_LOFC_VG_brms6_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
#                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
#                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
#                                       zi~sex+ neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
#                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh),
#                                    chains=4, cores=4, warmup=1000, iter=2000, family = zero_inflated_negbinomial(), 
#                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

######


print(model_LOFC_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh      0.0071    0.0317  -0.0552   0.0690 1.0018     4312     2551
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh  -0.0283    0.1391  -0.2932   0.2503 1.0003     3238     2878
save(model_LOFC_VG_hurdle_7, file = "model_LOFC_VG_hurdle_7.rda")


print(model_LOFC_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh      0.0196    0.0301  -0.0391   0.0778 1.0009     4272     3188
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   0.0678    0.1278  -0.1791   0.3220 1.0007     4011     3066

save(model_LOFC_VG_hurdle_8, file = "model_LOFC_VG_hurdle_8.rda")
#####
#PALLIDUM

print(model_PALL_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.0206    0.0594  -0.1379   0.0938 0.9999    21578     8352
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh   0.1603    0.2548  -0.3367   0.6677 1.0007    10866     8123
save(model_PALL_VG_hurdle_1, file = "model_PALL_VG_hurdle_1.rda")

#tfmri_antic_large_neutral_pall_RH
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh



print(model_PALL_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh      0.0411    0.0609  -0.0762   0.1633 0.9999    19470     8561
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh   0.0498    0.2503  -0.4429   0.5464 1.0000    12702     9400
save(model_PALL_VG_hurdle_2, file = "model_PALL_VG_hurdle_2.rda")

print(model_PALL_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.0697    0.0595  -0.1900   0.0473 1.0000    16854     8814
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh  -0.1609    0.2466  -0.6612   0.3137 1.0001    10579     7531

save(model_PALL_VG_hurdle_3, file = "model_PALL_VG_hurdle_3.rda")


print(model_PALL_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                    hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.0109    0.0615  -0.1310   0.1088 1.0001    11684     6048
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh   0.0282    0.2549  -0.4696   0.5224 1.0002     6699     5846
save(model_PALL_VG_hurdle_4, file = "model_PALL_VG_hurdle_4.rda")
load("model_PALLFreq4_brms.rda")
conditional_effects(model_PALLFreq4_brms)

# print(model_PALLFreq4_brms1 <- brm(bf(TotalGaming_Frequency ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
#                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+  
#                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
#                                       hu ~ tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh),
#                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_lognormal(),
#                                    control=list(adapt_delta=0.80), backend="cmdstanr", seed=1234, threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
# #tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.1596    0.0717  -0.3027  -0.0189 1.0020     6995     2786
####
####

print(model_PALL_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh      0.0291    0.0544  -0.0798   0.1366 1.0004     9499     5679
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh  -0.0596    0.2311  -0.5149   0.3921 1.0009     5919     5659
save(model_PALL_VG_hurdle_5, file = "model_PALL_VG_hurdle_5.rda")

# print(model_PALLFreq5_brms1 <- brm(bf(VGTotal_zero ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
#                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +    
#                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
#                                       hu ~ 1),
#                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(),
#                                    control=list(adapt_delta=0.80), backend="cmdstanr", seed=1234, threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
# # #tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh   0.0283    0.0539  -0.0769   0.1347 1.0021     6313     2431
######

print(model_PALL_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh      0.0570    0.0555  -0.0532   0.1673 0.9999     5302     2831
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh   0.1072    0.2276  -0.3360   0.5589 1.0019     3851     2900
save(model_PALL_VG_hurdle_6, file = "model_PALL_VG_hurdle_6.rda")

print(model_PALL_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh     -0.0034    0.0538  -0.1087   0.0996 1.0012     4635     2989
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh  -0.0033    0.2289  -0.4531   0.4456 1.0002     3736     3021
save(model_PALL_VG_hurdle_7, file = "model_PALL_VG_hurdle_7.rda")

print(model_PALL_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                    hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh      0.0113    0.0563  -0.0999   0.1228 1.0004    17423     5197
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh   0.5765    0.2572   0.0881   1.1011 1.0025     7966     5736
save(model_PALL_VG_hurdle_8, file = "model_PALL_VG_hurdle_8.rda")
conditional_effects(model_PALL_VG_brms8, effects="tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh", dpar="zi")
conditional_effects(model_PALL_VG_brms8, effects="CBCLAttention_Final_scaled", dpar="zi")
conditional_effects(model_PALL_VG_brms8, effects="pmq_y_ss_mean_scaled", dpar="zi")

zeroPart <- glmer(formula = I(VGTotal_zero>0) ~ 1 + sex+ (1|abcd_site/rel_family_id) ,
                  data    = ABCD_GamingYear2_QC,
                  family  = binomial(link = "logit"))

print(model_PALL_VG_brms8test <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh   0.4871    0.1895   0.1239   0.8601 1.0003     6254     2653
conditional_effects(model_PALL_VG_brms8test, effects="tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh", dpar="hu")
conditional_effects(model_PALL_VG_brms8test, effects="pmq_y_ss_mean", dpar="zi")

print(model_PALL_VG_brms8test1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                         zi~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=2000, family = zero_inflated_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#zi_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh   3.3242    2.2561  -0.4509   8.3270 1.0037      889     2002

print(model_PALL_VG_brms8test1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                         zi~
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=2000, family = zero_inflated_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#zi_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh   0.4905    0.4262  -0.2667   1.3965 1.0011     2633     2164
####
####
#caudate
print(model_CAUDATE_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id),
                                    hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0164    0.0481  -0.1086   0.0787 1.0000     7220     4256
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh   0.1982    0.2054  -0.1992   0.5988 1.0003     5044     4466
save(model_CAUDATE_hurdle_1, file = "model_CAUDATE_hurdle_1.rda")

print(model_CAUDATE_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0231    0.0485  -0.1205   0.0725 1.0008     7661     4024
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh   0.0952    0.2081  -0.3057   0.5076 1.0002     5621     4705
save(model_CAUDATE_hurdle_2, file = "model_CAUDATE_hurdle_2.rda")

#tfmri_largelossneutral_caudateLH
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh
print(model_CAUDATE_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=1000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0504    0.0493  -0.1474   0.0453 1.0003     4000     1509
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh   0.0173    0.2176  -0.4036   0.4464 1.0024     1954     1380
save(model_CAUDATE_VG_hurdle_3, file = "model_CAUDATE_VG_hurdle_3.rda")

print(model_CAUDATE_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh
                                       +(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=1000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0638    0.0516  -0.1638   0.0383 1.0008     3517     1435
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh  -0.0996    0.2125  -0.5306   0.3114 1.0027     2064     1671
save(model_CAUDATE_VG_hurdle_4, file = "model_CAUDATE_VG_hurdle_4.rda")

print(model_CAUDATE_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                       +(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=1000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh      0.0898    0.0480  -0.0045   0.1871 1.0030     2372     1343
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh   0.2034    0.2022  -0.1798   0.6040 1.0025     1653     1514
save(model_CAUDATE_VG_hurdle_5, file = "model_CAUDATE_VG_hurdle_5.rda")

print(model_CAUDATE_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                       +(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh      0.0919    0.0476  -0.0001   0.1858 1.0009    37515     9639
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.4267    0.2059   0.0307   0.8362 1.0000    16278    10049
save(model_CAUDATE_VG_hurdle_6, file = "model_CAUDATE_VG_hurdle_6.rda")

print(model_CAUDATE_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                       +(1|abcd_site/rel_family_id),
                                       hu ~ +sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh     -0.0114    0.0462  -0.1039   0.0797 1.0005    27129     9511
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh   0.3682    0.1925   0.0040   0.7550 1.0005    12911     8701
save(model_CAUDATE_VG_hurdle_7, file = "model_CAUDATE_VG_hurdle_7.rda")

print(model_CAUDATE_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                       +(1|abcd_site/rel_family_id),
                                       hu ~ +sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh     -0.0084    0.0470  -0.1001   0.0855 1.0028     5580     3007
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.3407    0.1974  -0.0405   0.7286 1.0011     3567     3361
save(model_CAUDATE_VG_hurdle_8, file = "model_CAUDATE_VG_hurdle_8.rda")

#####
#amygdala
print(model_Amyg_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh
                                    +(1|abcd_site/rel_family_id),
                                    hu ~ +sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh     -0.0570    0.0452  -0.1445   0.0324 1.0002     4503     2628
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh   0.0494    0.1798  -0.3029   0.4118 1.0002     3676     2774
meffects1 <- marginaleffects(model_Amyg_VG_brms1, vcov=FALSE)
library(marginaleffects)
plot1 <- plot_cme(model_Amyg_VG_hurdle_1, effect="VGTotal_zero", condition="tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh")
save(model_Amyg_VG_hurdle_1, file = "model_Amyg_VG_hurdle_1.rda")
load("model_Amyg_VG_hurdle_1.rda")


print(model_Amyg_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh
                                    +(1|abcd_site/rel_family_id),
                                    hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.0991    0.0452  -0.1892  -0.0099 1.0007    29421     8336
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh  -0.0681    0.1848  -0.4328   0.2956 1.0001    19737     9814
print(model_Amyg_VG_hurdle_2, digits=4)
save(model_Amyg_VG_hurdle_2, file = "model_Amyg_VG_hurdle_2.rda")
load("model_Amyg_VG_hurdle_2.rda")
plot1 <- conditional_effects(model_Amyg_VG_hurdle_2, effects = "tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh")
plot1

conditional_effects(model_Amyg_VG_hurdle_2)%>%
  plot(points=T)


 
print(model_Amyg_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh
                                    +(1|abcd_site/rel_family_id),
                                    hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh     -0.1068    0.0414  -0.1888  -0.0251 1.0003     4867     2623
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh  -0.0408    0.1695  -0.3731   0.2851 1.0014     3557     3144
 
save(model_Amyg_VG_hurdle_3, file = "model_Amyg_VG_hurdle_3.rda")
load("model_Amyg_VG_hurdle_3.rda")

print(model_Amyg_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh
                                    +(1|abcd_site/rel_family_id),
                                    hu ~ +sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.1058    0.0426  -0.1894  -0.0218 1.0007     6861     3062
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh  -0.0776    0.1839  -0.4485   0.2709 1.0022     3734     2998
save(model_Amyg_VG_hurdle_4, file = "model_Amyg_VG_hurdle_4.rda")

print(model_Amyg_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                    +(1|abcd_site/rel_family_id),
                                    hu ~ +sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(12), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh      0.0249    0.0378  -0.0479   0.1021 1.0003     5322     2779
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh  -0.0501    0.1502  -0.3394   0.2438 1.0007     4085     3422
save(model_Amyg_VG_hurdle_5, file = "model_Amyg_VG_hurdle_5.rda")

print(model_Amyg_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                    +(1|abcd_site/rel_family_id),
                                    hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh      0.0835    0.0403   0.0048   0.1628 1.0009    26534     8479
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh   0.0312    0.1687  -0.2922   0.3612 1.0006    16993     9648
save(model_Amyg_VG_hurdle_6, file = "model_Amyg_VG_hurdle_6.rda")

print(model_Amyg_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                    +(1|abcd_site/rel_family_id),
                                    hu~ +sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled + 
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh     -0.0272    0.0376  -0.1014   0.0468 1.0022     7784     3613
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh  -0.1195    0.1685  -0.4511   0.2043 1.0001     7311     4504
save(model_Amyg_VG_hurdle_7, file = "model_Amyg_VG_hurdle_7.rda")

print(model_Amyg_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                    +(1|abcd_site/rel_family_id),
                                    hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                      neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                      tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                 chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                 control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh      0.0005    0.0377  -0.0742   0.0738 1.0011     4410     2602
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh   0.0295    0.1429  -0.2410   0.3148 1.0012     3004     2999
save(model_Amyg_VG_hurdle_8, file = "model_Amyg_VG_hurdle_8.rda")

########
#putamen

summary(model_PM_VG_hurdle_1 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh     -0.0372    0.0595  -0.1533   0.0811 1.0008    10065     5533
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh  -0.0578    0.2469  -0.5467   0.4162 1.0001     6672     5677

summary(model_PM_VG_hurdle_2 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
print(model_PM_VG_hurdle_2, digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh     -0.0268    0.0577  -0.1403   0.0858 1.0002     9821     5602
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh  -0.0694    0.2439  -0.5360   0.4015 1.0003     7002     5636

summary(model_PM_VG_hurdle_3 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.99), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
print(model_PM_VG_hurdle_3, digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh     -0.1195    0.0603  -0.2372  -0.0004 1.0001    10241     5567
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh  -0.2269    0.2629  -0.7369   0.2830 1.0014     6153     5714


print(model_PM_VG_hurdle_4 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                     hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh     -0.0909    0.0602  -0.2062   0.0246 1.0004    10646     5935
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh  -0.1560    0.2605  -0.6762   0.3435 1.0014     5091     5677

print(model_PM_VG_hurdle_5 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                     hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh      0.0718    0.0550  -0.0363   0.1780 1.0017    10976     5329
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh   0.3516    0.2361  -0.1101   0.8272 1.0005     5699     5033

print(model_PM_VG_hurdle_6 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                     hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh   0.4492    0.2448  -0.0266   0.9372 1.0003     6488     5626
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh      0.0688    0.0559  -0.0404   0.1792 1.0016    13598     5543
#####
print(model_PM_VG_hurdle_7 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                     hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh     -0.0145    0.0199  -0.0530   0.0250 1.0004     4950     6072
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh   0.0085    0.2942  -0.5694   0.5795 1.0009     7363     6602

print(model_PM_VG_hurdle_8 <- brm(bf(VGTotal_zero ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                     hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                       neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                       tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                  chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                  control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh     -0.0172    0.0200  -0.0561   0.0218 1.0012     4516     6010
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh   0.2007    0.3201  -0.4225   0.8291 1.0000     6942     6373


######
######
#Everything below here deals with online gamine frequency as an outcome
# The extra models are related to the sensitivity analysis

summary(model_NACC_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                         hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh      0.0107    0.0404  -0.0680   0.0906 1.0000    20363    11988
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh   0.2362    0.1159   0.0123   0.4681 1.0017    14896     9359
print(model_NACC_Multi_hurdle_1, digits=4)
save(model_NACC_Multi_hurdle_1, file = "model_NACC_Multi_hurdle_1.rda")

#TotalGaming_FrequencyMulti_Minutes_Win
summary(model_NACC_Multi_hurdle_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                            hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh      0.0168    0.0397  -0.0616   0.0933 1.0010     4500     4366
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh   0.2387    0.1150   0.0191   0.4668 1.0010     4637     3658

summary(model_NACC_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                            hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh      0.0143    0.0357  -0.0546   0.0857 1.0004    12753     7037
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh   0.2358    0.1170   0.0125   0.4689 1.0010     5672     6190
#####

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh
print(model_NACC_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                       hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh     -0.0266    0.0414  -0.1059   0.0544 1.0003     4441     4323
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.1174    0.1155  -0.1043   0.3500 1.0004     5084     3666
save(model_NACC_Multi_brms2, file = "model_NACC_Multi_brms2.rda")

print(model_NACC_Multi_hurdle_2_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                          hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh     -0.0207    0.0424  -0.1013   0.0625 1.0005     5262     4336
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.1162    0.1146  -0.1039   0.3472 1.0001     6101     4575
###
print(model_NACC_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                          hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh     -0.0208    0.0374  -0.0924   0.0529 1.0002     7661     5942
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.1159    0.1162  -0.1082   0.3454 1.0005     8737     7301
#####

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh
print(model_NACC_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                       hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh      0.0372    0.0371  -0.0347   0.1102 1.0000     5197     4646
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.1593    0.1089  -0.0507   0.3751 1.0009     4509     4310
save(model_NACC_Multi_brms3, file = "model_NACC_Multi_brms3.rda")
conditional_effects(model_NACC_VG_brms3)
brmsmargins(model_NACC_VG_brms3)

print(model_NACC_Multi_hurdle_3_win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                          hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh      0.0346    0.0362  -0.0360   0.1049 1.0001     5160     4513
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.1575    0.1094  -0.0539   0.3767 1.0000     3745     3973
#########
 
#######
print(model_NACC_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                          hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh      0.0342    0.0330  -0.0305   0.0980 1.0018     6715     5929
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.1525    0.1100  -0.0550   0.3706 1.0028     2791     4321
######
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh
print(model_NACC_Multi_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                       hu~+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=500, iter=1000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh      0.0084    0.0402  -0.0709   0.0877 1.0003     1617     1483
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.1031    0.1118  -0.1230   0.3276 1.0021     1813     1448
save(model_NACC_Multi_brms4, file = "model_NACC_Multi_brms4.rda")


print(model_NACC_Multi_hurdle_4_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                          hu~+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh      0.0105    0.0386  -0.0644   0.0865 1.0016     5019     4514
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.0982    0.1106  -0.1177   0.3132 1.0015     4431     3677
####
print(model_NACC_Multi_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                          hu~+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh      0.0175    0.0343  -0.0489   0.0850 1.0005     5835     4982
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.0999    0.1103  -0.1186   0.3186 1.0019     4033     3909
####
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh
print(model_NACC_Multi_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh     -0.0559    0.0372  -0.1285   0.0198 1.0004     3003     2920
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.1417    0.1092  -0.0713   0.3567 1.0004     4251     2798
save(model_NACC_Multi_brms5 , file = "model_NACC_Multi_brms5.rda")
load("model_NACC_VG_brms5 .rda")
conditional_effects(model_NACC_VG_brms5 )

print(model_NACC_Multi_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh     -0.0598    0.0365  -0.1314   0.0109 1.0027     3290     2485
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.1412    0.1083  -0.0666   0.3597 1.0038     3602     2865
##
print(model_NACC_Multi_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh     -0.0479    0.0339  -0.1137   0.0180 1.0032     8162     5594
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.lh   0.1438    0.1103  -0.0690   0.3651 1.0007     6160     4323
####

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh
print(model_NACC_Multi_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh     -0.0978    0.0386  -0.1729  -0.0217 1.0012     2766     3334
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.1141    0.1042  -0.0904   0.3181 0.9996     4318     2802
save(model_NACC_Multi_brms6, file = "model_NACC_Multi_brms6.rda")

print(model_NACC_Multi_hurdle_6_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh     -0.0983    0.0375  -0.1745  -0.0257 1.0005     3484     2877
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.1108    0.1065  -0.0944   0.3254 1.0023     3792     2817
####
print(model_NACC_Multi_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                              hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                           chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                           control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh     -0.0863    0.0334  -0.1535  -0.0216 1.0002    10220     5275
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_accumbens.area.rh   0.1116    0.1100  -0.1006   0.3322 1.0005     8322     5013
####
####
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh
print(model_NACC_Multi_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh      0.0320    0.0417  -0.0511   0.1150 1.0006     9390     6516
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh   0.2860    0.1219   0.0507   0.5319 1.0000     5804     6248
save(model_NACC_Multi_brms7, file = "model_NACC_Multi_brms7.rda")
 
##########

#######

print(model_NACC_Multi_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh      0.0365    0.0413  -0.0438   0.1178 1.0003     4480     4258
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh   0.2859    0.1181   0.0579   0.5155 1.0012     4443     4213
######
 
######

print(model_NACC_Multi_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id),
                                              hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh+(1|abcd_site/rel_family_id)),
                                           chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                           control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh      0.0314    0.0370  -0.0403   0.1048 1.0004    13413     7356
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.lh   0.2861    0.1210   0.0573   0.5327 1.0004     6224     6133
#####

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh

print(model_NACC_Multi_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh      0.0142    0.0410  -0.0661   0.0946 1.0001    15728    10114
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.1490    0.1194  -0.0796   0.3870 1.0001    17470     8487
save(model_NACC_Multi_brms8, file = "model_NACC_Multi_brms8.rda")

###
print(model_NACC_Multi_hurdle_8_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh      0.0191    0.0404  -0.0610   0.0981 0.9998     5776     4542
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.1481    0.1176  -0.0864   0.3821 1.0010     5810     4461

#####
print(model_NACC_Multi_hurdle_8_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id),
                                              hu~sex+interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh+(1|abcd_site/rel_family_id)),
                                           chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                           control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh      0.0182    0.0363  -0.0530   0.0886 1.0009    11466     4447
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_accumbens.area.rh   0.1466    0.1162  -0.0783   0.3775 1.0014     6483     4532
####

#VMPFC
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x

print(model_VMPFC_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0199    0.0284  -0.0758   0.0339 1.0009     4222     3307
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x   0.1090    0.0803  -0.0461   0.2676 1.0015     5267     2802
save(model_VMPFC_Multi_brms1, file = "model_VMPFC_Multi_brms1.rda")

print(model_VMPFC_Multi_hurdle_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0140    0.0273  -0.0670   0.0398 1.0003     5511     4526
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x   0.1097    0.0810  -0.0466   0.2721 1.0003     7154     4710
###
print(model_VMPFC_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0054    0.0246  -0.0537   0.0427 1.0003     6289     2920
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x   0.1091    0.0798  -0.0470   0.2688 1.0006     3775     2793
####

##tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x
print(model_VMPFC_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0489    0.0298  -0.1064   0.0092 1.0003     3791     3077
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0199    0.0849  -0.1463   0.1866 1.0020     5584     3198
save(model_VMPFC_Multi_brms2, file = "model_VMPFC_Multi_brms2.rda")
##
print(model_VMPFC_Multi_hurdle_2_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0412    0.0288  -0.0985   0.0145 1.0012     4488     4555
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0197    0.0854  -0.1497   0.1858 1.0003     5996     4406
##
print(model_VMPFC_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0296    0.0258  -0.0791   0.0193 1.0044     1368      592
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0225    0.0830  -0.1480   0.1833 1.0024     3196     2454
###

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y
print(model_VMPFC_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y      0.0061    0.0220  -0.0387   0.0486 1.0002    11492     6354
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y   0.0725    0.0654  -0.0522   0.2059 0.9999    11722     6074
save(model_VMPFC_Multi_brms3, file = "model_VMPFC_Multi_brms3.rda")

print(model_VMPFC_Multi_hurdle_3_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y      0.0073    0.0216  -0.0351   0.0495 1.0016     5070     4009
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y   0.0725    0.0675  -0.0548   0.2127 1.0011     4385     3767

print(model_VMPFC_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y      0.0143    0.0188  -0.0235   0.0499 1.0011     9979     4513
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.y   0.0725    0.0660  -0.0505   0.2066 1.0026     6530     6024
####
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y
print(model_VMPFC_Multi_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y      0.0013    0.0265  -0.0519   0.0530 1.0010     4121     2975
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y   0.0545    0.0774  -0.0937   0.2072 1.0002     4052     2777
save(model_VMPFC_Multi_brms4, file = "model_VMPFC_Multi_brms4.rda")

print(model_VMPFC_Multi_hurdle_4_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y      0.0048    0.0264  -0.0462   0.0570 1.0008     6260     4473
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y   0.0519    0.0807  -0.1040   0.2109 1.0000     7614     4363

print(model_VMPFC_Multi_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y      0.0166    0.0228  -0.0270   0.0613 1.0022     3732     2490
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.y   0.0519    0.0757  -0.0957   0.1976 1.0030     3885     2711
######

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x
print(model_VMPFC_Multi_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0024    0.0289  -0.0587   0.0541 1.0003     3324     2966
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x   0.1016    0.0798  -0.0533   0.2601 1.0014     4291     2852
save(model_VMPFC_Multi_brms5, file = "model_VMPFC_Multi_brms5.rda")

print(model_VMPFC_Multi_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x      0.0007    0.0277  -0.0532   0.0533 0.9996     3099     1955
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x   0.1025    0.0822  -0.0597   0.2663 0.9999     3398     1913
#####

print(model_VMPFC_Multi_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x      0.0037    0.0253  -0.0452   0.0520 1.0005    11181     5395
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.lh.x   0.1013    0.0800  -0.0540   0.2604 1.0017     9137     5414
####

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x
print(model_VMPFC_Multi_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0569    0.0298  -0.1142   0.0020 1.0002     6758     6068
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0392    0.0838  -0.1234   0.2066 1.0002     9004     5540

save(model_VMPFC_Multi_brms6, file = "model_VMPFC_Multi_brms6.rda")

print(model_VMPFC_Multi_hurdle_6_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0524    0.0285  -0.1080   0.0032 1.0003     8601     7776
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0369    0.0825  -0.1242   0.2012 1.0004    11266     6648
######

print(model_VMPFC_Multi_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0443    0.0256  -0.0943   0.0071 1.0007     9177     5028
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_medialorbitofrontal.rh.x   0.0397    0.0819  -0.1223   0.2065 1.0000     8577     5497
#####

# tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x
print(model_VMPFC_Multi_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0439    0.0232  -0.0899   0.0012 0.9998     3517     3327
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x  -0.0549    0.0697  -0.1911   0.0855 1.0012     4569     2752
save(model_VMPFC_Multi_brms7, file = "model_VMPFC_Multi_brms7.rda")

print(model_VMPFC_Multi_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0425    0.0227  -0.0867   0.0023 1.0007     5415     4989
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x  -0.0547    0.0709  -0.1948   0.0842 1.0002     5692     4485
######
print(model_VMPFC_Multi_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x     -0.0305    0.0209  -0.0725   0.0099 1.0009    12339     4951
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.lh.x  -0.0555    0.0683  -0.1883   0.0832 1.0002    10033     6426
######

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x
print(model_VMPFC_Multi_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                        hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0412    0.0238  -0.0874   0.0048 1.0006     3240     3193
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x   0.0263    0.0720  -0.1130   0.1683 1.0004     4583     3001
save(model_VMPFC_Multi_brms8, file = "model_VMPFC_Multi_brms8.rda")
 
#########
print(model_VMPFC_Multi_hurdle_8_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0413    0.0233  -0.0877   0.0046 1.0014     5583     4792
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x   0.0272    0.0703  -0.1103   0.1660 1.0013     5508     4086
##
print(model_VMPFC_Multi_hurdle_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id),
                                           hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                             neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                             tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x+(1|abcd_site/rel_family_id)),
                                        chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                        control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x     -0.0281    0.0206  -0.0686   0.0135 1.0008     3692     4623
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_medialorbitofrontal.rh.x   0.0250    0.0717  -0.1109   0.1692 1.0010     6130     4168
#####
#insula
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh
print(model_Insula_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                         hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)


#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh     -0.1793    0.0842  -0.3392  -0.0146 1.0001     2711     3016
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh   0.3668    0.2325  -0.0928   0.8314 1.0010     3093     2526
save(model_Insula_Multi_brms1, file = "model_Insula_Multi_brms1.rda")


print(model_Insula_Multi_hurdle_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh     -0.1433    0.0829  -0.3054   0.0196 0.9999    16001    10937
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh   0.3660    0.2376  -0.0940   0.8392 1.0005    20106    10625

print(model_Insula_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh     -0.1364    0.0732  -0.2801   0.0049 1.0003    22426     8559
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.lh   0.3669    0.2335  -0.0862   0.8331 1.0001    18784     9235

###
#####
 
###

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh
print(model_Insula_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                         hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh     -0.1818    0.0791  -0.3353  -0.0252 1.0011     7974     8911
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh   0.3758    0.2283  -0.0764   0.8254 1.0008    10379     8911

save(model_Insula_Multi_brms2, file = "model_Insula_Multi_brms2.rda")

#######

 



print(model_Insula_Multi_hurdle_2_Win1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                  neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                  tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                                hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                  neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                  tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                             chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                             control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh     -0.1634    0.0796  -0.3192  -0.0089 1.0003     8533     7502
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh   0.3695    0.2281  -0.0705   0.8276 1.0004    11100     7659

print(model_Insula_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh     -0.1453    0.0719  -0.2864  -0.0029 1.0022    11467     5132
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_insula.rh   0.3754    0.2311  -0.0732   0.8264 1.0003     8406     6181

#######

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh
print(model_Insula_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                         hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh     -0.0080    0.0702  -0.1435   0.1303 1.0012     2845     3009
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.1830    0.2034  -0.2136   0.5703 1.0006     3469     3005
save(model_Insula_Multi_brms3, file = "model_Insula_Multi_brms3.rda")
# 
################################## 
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh

#
print(model_Insula_Multi_hurdle_3_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh     -0.0206    0.0664  -0.1492   0.1104 1.0004     6460     4805
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.1781    0.2093  -0.2206   0.6005 1.0003     6579     4539


print(model_Insula_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh     -0.0008    0.0611  -0.1226   0.1204 1.0014     8559     4675
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.1770    0.2081  -0.2259   0.5852 1.0005     7668     5139
####
##


print(model_Insula_Multi_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                         hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh     -0.0199    0.0695  -0.1596   0.1164 1.0009     2732     2983
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh   0.0608    0.2122  -0.3504   0.4646 1.0027     5626     3231

save(model_Insula_Multi_brms4, file = "model_Insula_Multi_brms4.rda")

print(model_Insula_Multi_hurdle_4_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh     -0.0321    0.0688  -0.1665   0.1067 1.0000     4454     2848
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh   0.0682    0.2083  -0.3393   0.4777 1.0010     4957     2734
###
print(model_Insula_Multi_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh     -0.0242    0.0624  -0.1471   0.0989 1.0008     6113     5069
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_insula.rh   0.0637    0.2169  -0.3577   0.4843 1.0002     8715     5494
###

print(model_Insula_Multi_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                         hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh     -0.1199    0.0839  -0.2842   0.0408 1.0015     3744     3111
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh   0.2217    0.2425  -0.2551   0.6951 0.9994     4795     2983
save(model_Insula_Multi_brms5, file = "model_Insula_Multi_brms5.rda")
conditional_effects(model_InsulaFreq5_brms)

print(model_Insula_Multi_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh     -0.0933    0.0809  -0.2510   0.0663 1.0004    22636    11776
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh   0.2165    0.2406  -0.2500   0.6906 1.0001    24125    11225

print(model_Insula_Multi_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh     -0.0805    0.0743  -0.2271   0.0627 1.0006     9768     4039
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.lh   0.2168    0.2444  -0.2623   0.6988 1.0007     8518     5185
####

print(model_Insula_Multi_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                         hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh     -0.0967    0.0820  -0.2549   0.0676 1.0020     4287     3444
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh   0.2999    0.2363  -0.1666   0.7791 1.0000     5132     2801
save(model_Insula_Multi_brms6, file = "model_Insula_Multi_brms6.rda")

print(model_Insula_Multi_hurdle_6_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh     -0.0672    0.0784  -0.2212   0.0886 1.0006     3215     2995
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh   0.2915    0.2376  -0.1672   0.7710 0.9995     3554     3190
####

print(model_Insula_Multi_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh     -0.0537    0.0707  -0.1932   0.0852 1.0011     7653     4332
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_insula.rh   0.2982    0.2326  -0.1366   0.7666 1.0012     6128     5416
###

print(model_Insula_Multi_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                         hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh     -0.0641    0.0738  -0.2086   0.0794 1.0004     8232     9113
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.0042    0.2139  -0.4148   0.4274 1.0004    11534     9151
save(model_Insula_Multi_brms7, file = "model_Insula_Multi_brms7.rda")

print(model_Insula_Multi_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh     -0.0803    0.0721  -0.2217   0.0627 1.0016     1368      614
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.0171    0.2190  -0.4069   0.4519 1.0153      264      251
####
print(model_Insula_Multi_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id),
                                            hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh     -0.0649    0.0668  -0.1954   0.0649 1.0051     1748      595
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.lh   0.0057    0.2189  -0.4266   0.4310 1.0018     3482     3623
#####
print(model_Insula_Multi_hurdle_8  <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh     -0.1259    0.0719  -0.2684   0.0154 1.0014     2442     2307
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh  -0.1416    0.2052  -0.5589   0.2538 1.0024     3334     2482
save(model_Insula_Multi_brms8, file = "model_Insula_Multi_brms8.rda")
#####
print(model_Insula_Multi_hurdle_8_Win  <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                             hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                          chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh     -0.1413    0.0688  -0.2733  -0.0068 1.0001    18813    11412
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh  -0.1467    0.2112  -0.5617   0.2657 1.0006    17935     9796
####
print(model_Insula_Multi_hurdle_8_MAD  <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id),
                                             hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh+(1|abcd_site/rel_family_id)),
                                          chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh     -0.1256    0.0636  -0.2512  -0.0010 1.0001     9225     5428
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_insula.rh  -0.1416    0.2044  -0.5402   0.2519 1.0019     6389     5256
####
#DACC
#tfmri_AnticLargeRewardNeutral_DACC_LH
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh
print(model_DACC_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.1196    0.0668  -0.2488   0.0119 1.0002     8430     8948
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh   0.2115    0.1908  -0.1569   0.5900 1.0003    10827     8421
save(model_DACC_Multi_brms1, file = "model_DACC_Multi_brms1.rda")

print(model_DACC_Multi_hurdle_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0972    0.0665  -0.2293   0.0339 1.0001     5475     4516
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh   0.2114    0.1930  -0.1607   0.5908 0.9998     6670     4723
####
print(model_DACC_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0876    0.0584  -0.2009   0.0259 1.0010     2470     2742
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh   0.2170    0.1872  -0.1588   0.5769 1.0018     2409     3017

####

#tfmri_AnticLargeRewardNeutral_DACC_RH
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh
print(model_DACC_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh     -0.1277    0.0681  -0.2600   0.0066 0.9999     9887     9022
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh   0.2430    0.1993  -0.1408   0.6415 1.0002    13048     8213
save(model_DACC_Multi_brms2, file = "model_DACC_Multi_brms2.rda")

print(model_DACC_Multi_hurdle_2_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0983    0.0658  -0.2288   0.0334 1.0003     3436     2617
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh   0.2367    0.1925  -0.1508   0.6149 1.0033     3293     2540

print(model_DACC_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0827    0.0602  -0.2003   0.0362 0.9999     8758     5257
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh   0.2406    0.1968  -0.1413   0.6276 1.0022     7385     5478

####
######

print(model_DACC_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh      0.0008    0.0594  -0.1153   0.1179 1.0004     9405     9331
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh   0.1853    0.1833  -0.1720   0.5441 1.0000    12712     8579
save(model_DACC_Multi_brms3, file = "model_DACC_Multi_brms3.rda")
rm(model_DACCFreq3_brms)
load("model_DACCFreq3_brms.rda")
print(model_DACCFreq3_brms, digits=4)

print(model_DACC_Multi_hurdle_3_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0029    0.0588  -0.1196   0.1134 1.0000     5022     4646
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh   0.1860    0.1834  -0.1703   0.5564 1.0010     7164     3868
#####
print(model_DACC_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh      0.0063    0.0526  -0.0925   0.1135 1.0030     1105      565
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh   0.1801    0.1782  -0.1663   0.5287 1.0020     5234     4646
####

print(model_DACC_Multi_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)


#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0250    0.0605  -0.1447   0.0956 1.0002     9310     8963
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh   0.1372    0.1868  -0.2271   0.5087 1.0001    11863     8199
save(model_DACC_Multi_brms4, file = "model_DACC_Multi_brms4.rda")

print(model_DACC_Multi_hurdle_4_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0245    0.0599  -0.1452   0.0922 1.0000     5483     4554
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh   0.1403    0.1878  -0.2237   0.5066 1.0013     6604     4406
###
print(model_DACC_Multi_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0078    0.0524  -0.1106   0.0948 1.0003     8372     5034
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh   0.1354    0.1841  -0.2160   0.4982 1.0009     7493     6334
#####

print(model_DACC_Multi_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0753    0.0686  -0.2098   0.0598 1.0003     9886     9248
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh   0.2106    0.1983  -0.1810   0.6096 1.0001    11709     8531


save(model_DACC_Multi_brms5, file = "model_DACC_Multi_brms5.rda")

print(model_DACC_Multi_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0677    0.0684  -0.2022   0.0674 1.0008    17098    10034
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh   0.2088    0.2004  -0.1802   0.6039 1.0002    19905     7965
###

print(model_DACC_Multi_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh     -0.0535    0.0621  -0.1750   0.0680 1.0004    13414     5762
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.lh   0.2082    0.1946  -0.1637   0.5920 1.0001    10420     5803
####

print(model_DACC_Multi_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0191    0.0698  -0.1548   0.1184 1.0003     6969     6188
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh   0.3312    0.2056  -0.0615   0.7463 1.0010     7101     4504

save(model_DACC_Multi_brms6, file = "model_DACC_Multi_brms6.rda")

print(model_DACC_Multi_hurdle_6_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0076    0.0698  -0.1454   0.1281 1.0003     8945     6197
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh   0.3259    0.2048  -0.0742   0.7249 1.0008     9663     6224

print(model_DACC_Multi_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh     -0.0143    0.0619  -0.1371   0.1060 1.0009     6928     5237
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_caudalanteriorcingulate.rh   0.3376    0.2070  -0.0621   0.7455 1.0003     6752     5054
####

print(model_DACC_Multi_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh     -0.1391    0.0613  -0.2587  -0.0175 1.0004     4030     3251
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh  -0.1295    0.1435  -0.4105   0.1501 1.0033     7081     2913
save(model_DACC_Multi_brms7, file = "model_DACC_Multi_brms7.rda")
######

print(model_DACC_Multi_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh     -0.1441    0.0573  -0.2583  -0.0297 1.0003     6496     4846
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh  -0.1271    0.1474  -0.4113   0.1636 1.0003    10165     4402

print(model_DACC_Multi_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh     -0.1187    0.0521  -0.2214  -0.0167 1.0003     8091     4979
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.lh  -0.1259    0.1456  -0.4089   0.1615 1.0006     7197     3769
#####
######

print(model_DACC_Multi_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)


#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh     -0.1084    0.0651  -0.2331   0.0215 1.0005     2536     2304
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh  -0.1339    0.1866  -0.5090   0.2360 1.0002     4070     2849
save(model_DACC_Multi_brms8, file = "model_DACC_Multi_brms8.rda")
###
print(model_DACC_Multi_hurdle_8_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh     -0.1178    0.0640  -0.2434   0.0076 1.0009     3576     2784
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh  -0.1373    0.1821  -0.5046   0.2123 1.0019     3607     2754
#

print(model_DACC_Multi_hurdle_8_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh     -0.1105    0.0561  -0.2211   0.0004 1.0003    22124     8126
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_caudalanteriorcingulate.rh  -0.1346    0.1859  -0.4952   0.2310 1.0003    17397     8826
####
#LOFC
tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh

print(model_LOFC_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0715    0.0424  -0.1533   0.0112 1.0009     3054     2912
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh   0.1079    0.1234  -0.1322   0.3544 1.0000     4030     2935
save(model_LOFC_Multi_brms1, file = "model_LOFC_Multi_brms1.rda")

print(model_LOFC_Multi_hurdle_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0561    0.0419  -0.1373   0.0249 1.0004     3454     3184
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh   0.1081    0.1241  -0.1378   0.3489 1.0001     4581     3164

print(model_LOFC_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0412    0.0378  -0.1166   0.0330 1.0006     9028     4316
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh   0.1099    0.1240  -0.1301   0.3479 1.0016     8860     3527
####


print(model_LOFC_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0563    0.0417  -0.1380   0.0256 1.0007     3128     3305
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.0818    0.1206  -0.1518   0.3198 1.0015     4043     2812
save(model_LOFC_Multi_brms2, file = "model_LOFC_Multi_brms2.rda")


print(model_LOFC_Multi_hurdle_2_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0444    0.0426  -0.1273   0.0397 1.0011     7055     5602
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.0849    0.1202  -0.1517   0.3203 1.0010     9147     5666

print(model_LOFC_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0340    0.0387  -0.1100   0.0428 1.0020     2995     1375
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.0818    0.1207  -0.1533   0.3234 1.0038     5788     4655

#####
####

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh
print(model_LOFC_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0458    0.0441  -0.1319   0.0415 1.0009     8930     9276
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh   0.1496    0.1278  -0.0969   0.4008 1.0002    13420     9112
save(model_LOFC_Multi_brms3, file = "model_LOFC_Multi_brms3.rda")

print(model_LOFC_Multi_hurdle_3_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0419    0.0447  -0.1288   0.0470 1.0003     5818     5405
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh   0.1543    0.1276  -0.0932   0.4090 0.9999     5782     5412

print(model_LOFC_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh     -0.0157    0.0391  -0.0930   0.0588 1.0002     7521     3573
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.lh   0.1481    0.1284  -0.1002   0.4011 1.0003     6421     4792
####

print(model_LOFC_Multi_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0810    0.0455  -0.1724   0.0067 1.0005     3642     3007
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.1632    0.1227  -0.0769   0.4085 0.9997     5188     3241
save(model_LOFC_Multi_brms4, file = "model_LOFC_Multi_brms4.rda")

print(model_LOFC_Multi_hurdle_4_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0712    0.0430  -0.1550   0.0117 1.0007     6379     5541
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.1685    0.1265  -0.0776   0.4203 1.0014     7149     5240

print(model_LOFC_Multi_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh     -0.0617    0.0388  -0.1387   0.0138 1.0014    15278     5022
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_cort.desikan_lateralorbitofrontal.rh   0.1628    0.1258  -0.0833   0.4036 1.0014    11902     6008

####

print(model_LOFC_Multi_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh      0.0002    0.0344  -0.0673   0.0676 1.0005     2442     3002
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh   0.0601    0.1027  -0.1422   0.2667 1.0020     3235     2926
save(model_LOFC_Multi_brms5, file = "model_LOFC_Multi_brms5.rda")

print(model_LOFC_Multi_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh      0.0014    0.0337  -0.0640   0.0679 1.0014     8614     6074
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh   0.0603    0.1019  -0.1392   0.2632 1.0000     8287     5356


print(model_LOFC_Multi_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh      0.0168    0.0296  -0.0419   0.0729 1.0061     1457     4470
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh   0.0625    0.1011  -0.1349   0.2612 1.0025     5513     4747
####


print(model_LOFC_Multi_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh     -0.0173    0.0395  -0.0950   0.0598 1.0001     8098     9292
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   0.0341    0.1099  -0.1802   0.2503 1.0004    10940     8584
save(model_LOFC_Multi_brms6, file = "model_LOFC_Multi_brms6.rda")

print(model_LOFC_Multi_hurdle_6_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh     -0.0177    0.0373  -0.0908   0.0550 1.0003     6581     6392
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   0.0351    0.1115  -0.1849   0.2522 1.0002     7576     5541

print(model_LOFC_Multi_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh     -0.0015    0.0328  -0.0664   0.0632 1.0001    10452     4957
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh   0.0364    0.1114  -0.1821   0.2588 1.0000     7005     4860
####


print(model_LOFC_Multi_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh     -0.0407    0.0370  -0.1141   0.0312 1.0007     2791     2748
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh  -0.0905    0.1138  -0.3168   0.1288 1.0001     3885     2936
save(model_LOFC_Multi_brms7, file = "model_LOFC_Multi_brms7.rda")

print(model_LOFC_Multi_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh     -0.0414    0.0364  -0.1116   0.0310 1.0003     7226     4318
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh  -0.0891    0.1098  -0.3046   0.1223 1.0010     7807     4133
#####
print(model_LOFC_Multi_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh     -0.0274    0.0325  -0.0914   0.0347 1.0002     4710     3372
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.lh  -0.0923    0.1130  -0.3148   0.1283 1.0009     5753     4751
####


print(model_LOFC_Multi_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh     -0.0743    0.0360  -0.1445  -0.0028 0.9998    17792    10366
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh  -0.0908    0.1072  -0.3028   0.1194 1.0002    21517     9368

save(model_LOFC_Multi_brms8, file = "model_LOFC_Multi_brms8.rda")


print(model_LOFC_Multi_hurdle_8_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh     -0.0755    0.0358  -0.1436  -0.0038 1.0001     4682     4433
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh  -0.0899    0.1068  -0.3013   0.1182 1.0005     6932     4371

print(model_LOFC_Multi_hurdle_8_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh     -0.0768    0.0353  -0.1450  -0.0061 0.9998     4987     4282
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh  -0.0893    0.1054  -0.2988   0.1187 1.0015     5823     3787

#####
print(model_LOFC_Multi_hurdle_8_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh     -0.0583    0.0312  -0.1179   0.0034 0.9999     9162     5524
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_cort.desikan_lateralorbitofrontal.rh  -0.0892    0.1056  -0.3012   0.1187 1.0001     7138     4734
#####
#PALLIDUM

print(model_PALL_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.1293    0.0708  -0.2659   0.0106 1.0008     3192     3020
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh   0.1802    0.2035  -0.2271   0.5817 1.0003     4042     2614
save(model_PALL_Multi_brms1, file = "model_PALL_Multi_brms1.rda")

#tfmri_antic_large_neutral_pall_RH
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh

print(model_PALL_Multi_hurdle_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.1133    0.0704  -0.2535   0.0246 1.0009     5328     4252
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh   0.1786    0.2072  -0.2154   0.5860 1.0003     5949     3965
####

print(model_PALL_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.0928    0.0636  -0.2179   0.0311 1.0000    10484     5832
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.lh   0.1743    0.2069  -0.2282   0.5858 1.0001     9241     5990

####

print(model_PALL_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.0904    0.0709  -0.2274   0.0434 1.0004     3838     3352
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh   0.2030    0.2085  -0.2064   0.6172 1.0005     3940     2884
save(model_PALL_Multi_brms2, file = "model_PALL_Multi_brms2.rda")

print(model_PALL_Multi_hurdle_2_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.0749    0.0704  -0.2140   0.0606 1.0004     5562     3138
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh   0.2002    0.2067  -0.2053   0.6076 0.9996     6236     3222

print(model_PALL_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.0686    0.0655  -0.2009   0.0573 1.0005    12548     5611
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_pallidum.rh   0.2041    0.2056  -0.1977   0.6061 1.0002     8929     5867
###

print(model_PALL_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.0989    0.0702  -0.2357   0.0383 1.0010     5179     5547
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh   0.3715    0.2040  -0.0147   0.7795 1.0009     6740     4070

save(model_PALL_Multi_brms3, file = "model_PALL_Multi_brms3.rda")

print(model_PALL_Multi_hurdle_3_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.0897    0.0683  -0.2249   0.0452 1.0002     6254     5993
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh   0.3654    0.2074  -0.0433   0.7801 1.0003     6810     5136

print(model_PALL_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh     -0.0730    0.0613  -0.1951   0.0463 1.0013    11105     5285
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.lh   0.3612    0.2002  -0.0281   0.7669 1.0006     7976     5936
#####


print(model_PALL_Multi_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                       hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.0413    0.0766  -0.1904   0.1086 0.9999     6972     6385
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh   0.1203    0.2092  -0.2850   0.5285 1.0008     7856     4992
save(model_PALL_Multi_brms4, file = "model_PALL_Multi_brms4.rda")
load("model_PALLFreq4_brms.rda")
conditional_effects(model_PALLFreq4_brms)

print(model_PALL_Multi_hurdle_4_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.0279    0.0723  -0.1685   0.1140 1.0008     5997     6057
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh   0.1198    0.2103  -0.2880   0.5382 1.0009     7748     5394
# print(model_PALLFreq4_brms1 <- brm(bf(TotalGaming_Frequency ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
#                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+  
#                                         tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
#                                       hu ~ tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh),
#                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_lognormal(),
#                                    control=list(adapt_delta=0.80), backend="cmdstanr", seed=1234, threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
# #tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.1596    0.0717  -0.3027  -0.0189 1.0020     6995     2786
####

print(model_PALL_Multi_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu ~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh     -0.0206    0.0669  -0.1520   0.1095 1.0008     9617     5683
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_pallidum.rh   0.1175    0.2095  -0.2964   0.5397 1.0003     8797     5581
###
####

print(model_PALL_Multi_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh     -0.0014    0.0655  -0.1294   0.1265 1.0003     5649     5859
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh   0.0473    0.1876  -0.3173   0.4216 1.0006     7742     6174
save(model_PALL_Multi_brms5, file = "model_PALL_Multi_brms5.rda")

print(model_PALL_Multi_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh     -0.0115    0.0623  -0.1337   0.1110 1.0003     7497     5922
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh   0.0482    0.1863  -0.3089   0.4291 1.0003     8492     6238
 
######

print(model_PALL_Multi_hurdle_5_MAD<- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh     -0.0050    0.0555  -0.1160   0.1073 1.0002     8392     5120
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh   0.0446    0.1908  -0.3272   0.4128 1.0004     8017     6156

####

print(model_PALL_Multi_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh      0.0736    0.0669  -0.0568   0.2075 1.0003     5233     5607
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh  -0.0791    0.1878  -0.4415   0.2878 1.0001     7660     5555
save(model_PALL_Multi_brms6, file = "model_PALL_Multi_brms6.rda")

print(model_PALL_Multi_hurdle_6_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh      0.0562    0.0660  -0.0748   0.1846 1.0003     7158     5576
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh  -0.0774    0.1890  -0.4528   0.2936 1.0003     7020     5470


print(model_PALL_Multi_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh      0.0493    0.0582  -0.0651   0.1622 1.0011    10067     5925
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh  -0.0826    0.1902  -0.4588   0.2825 1.0011     8929     5558

####

print(model_PALL_Multi_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh     -0.0664    0.0660  -0.1952   0.0660 1.0011     6025     6156
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh  -0.0833    0.1860  -0.4514   0.2877 1.0003     7800     5730
save(model_PALL_Multi_brms7, file = "model_PALL_Multi_brms7.rda")

print(model_PALL_Multi_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh     -0.0697    0.0629  -0.1918   0.0510 1.0013     6145     5540
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh  -0.0855    0.1870  -0.4500   0.2755 1.0007     6762     4839
####
print(model_PALL_Multi_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh     -0.0619    0.0562  -0.1744   0.0485 1.0001     7208     5261
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.lh  -0.0830    0.1844  -0.4504   0.2738 1.0012     4063     4901
#####
print(model_PALL_Multi_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                       hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh     -0.0565    0.0683  -0.1885   0.0733 1.0008     3274     3140
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh  -0.2105    0.1990  -0.5996   0.1765 1.0002     3566     2538
save(model_PALL_VG_brms8, file = "model_PALL_VG_brms8.rda")

print(model_PALL_Multi_hurdle_8_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh     -0.0737    0.0660  -0.2040   0.0558 1.0004     5490     5763
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh  -0.2125    0.1985  -0.5929   0.1788 1.0004     8092     5571
####

print(model_PALL_Multi_hurdle_8_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id),
                                          hu~sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh     -0.0724    0.0582  -0.1882   0.0409 1.0009     9733     5730
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_pallidum.rh  -0.2146    0.1955  -0.6003   0.1662 1.0002     7974     5310
####
#caudate
print(model_CAUDATE_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id),
                                         hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0608    0.0593  -0.1739   0.0545 1.0006     5485     5846
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh   0.3340    0.1654   0.0127   0.6581 1.0009     7104     5517
save(model_CAUDATE_Multi_hurdle_1, file = "model_CAUDATE_Multi_hurdle_1.rda")

print(model_CAUDATE_Multi_hurdle_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id),
                                             hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                          chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0443    0.0583  -0.1581   0.0715 1.0001     7739     6312
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh   0.3401    0.1719   0.0054   0.6901 1.0016     3118     2532
####
print(model_CAUDATE_Multi_hurdle_1_cap <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                   neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                   tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id),
                                                 hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                   neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                   tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                              chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                              control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC_Cap), digits=4)
#ABCD_GamingYear2_QC_Cap (Number of observations: 4526) 
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0575    0.0542  -0.1629   0.0492 1.0032     3435     2799
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh   0.3447    0.1741   0.0053   0.6947 1.0002     7713     5351

######
print(model_CAUDATE_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                   neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                   tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id),
                                                 hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                                   neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                                   tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                              chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                              control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0366    0.0530  -0.1418   0.0681 1.0004     6327     4299
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.lh   0.3309    0.1689   0.0081   0.6676 1.0025     4571     3117
#####
######


print(model_CAUDATE_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id),
                                         hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0494    0.0601  -0.1649   0.0683 1.0003     6865     6027
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh   0.2835    0.1385   0.0101   0.5553 1.0002    13233     5678
save(model_CAUDATEFreq2_brms, file = "model_CAUDATEFreq2_brms.rda")

print(model_CAUDATE_Multi_hurdle_2_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id),
                                             hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh),
                                          chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0374    0.0587  -0.1520   0.0754 1.0001     9183     6
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh   0.2828    0.1389   0.0099   0.5557 1.0012    14540     536
####
 

print(model_CAUDATE_Multi_hurdle_2_cap <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id),
                                             hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh),
                                          chains=4, cores=4, warmup=1000, iter=2000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC_Cap), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0653    0.0547  -0.1756   0.0412 1.0012     5332     2792
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh   0.2806    0.1404   0.0053   0.5552 1.0002     5566     2487
######

print(model_CAUDATE_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id),
                                             hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh),
                                          chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0433    0.0520  -0.1457   0.0582 1.0017     1707      716
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_caudate.rh   0.2827    0.1369   0.0135   0.5466 1.0008     7180     4800
###
#tfmri_largelossneutral_caudateLH
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh
print(model_CAUDATE_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0235    0.0623  -0.1457   0.1004 1.0013     7077     6128
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh   0.3732    0.1768   0.0323   0.7259 1.0003     6698     4596
save(model_CAUDATE_VG_brms3, file = "model_CAUDATE_VG_brms3.rda")

print(model_CAUDATE_Multi_hurdle_3_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh
                                             +(1|abcd_site/rel_family_id),
                                             hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                          chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0054    0.0606  -0.1234   0.1148 1.0004     8037     5894
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh   0.3725    0.1745   0.0345   0.7146 1.0004     5095     5816
####

print(model_CAUDATE_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh
                                             +(1|abcd_site/rel_family_id),
                                             hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                               neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                               tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                          chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                          control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh     -0.0001    0.0535  -0.1041   0.1054 1.0004     8480     5677
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.lh   0.3747    0.1741   0.0357   0.7176 1.0014     5513     5911
####

print(model_CAUDATEMulti_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3500, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0164    0.0612  -0.1350   0.1019 1.0001    10395     8236
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh   0.3180    0.1746  -0.0189   0.6648 1.0001     9423     7194
save(model_CAUDATE_VG_brms4, file = "model_CAUDATE_VG_brms4.rda")

print(model_CAUDATEMulti_hurdle_4_1_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0020    0.0594  -0.1202   0.1126 0.9999     7510     59
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh   0.3211    0.1733  -0.0122   0.6675 1.0005     7114     5536

print(model_CAUDATEMulti_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3500, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh     -0.0008    0.0530  -0.1055   0.1032 1.0014    10605     6841
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_caudate.rh   0.3190    0.1755  -0.0179   0.6735 1.0009     6060     3945
####

print(model_CAUDATEMulti_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh      0.0587    0.0554  -0.0489   0.1689 1.0001    18266    10922
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh   0.0832    0.1634  -0.2336   0.4035 1.0002    21782     9227
save(model_CAUDATEMulti_hurdle_5, file = "model_CAUDATEMulti_hurdle_5.rda")
 

print(model_CAUDATEMulti_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh      0.0518    0.0546  -0.0577   0.1570 1.0011     6345     5969
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh   0.0825    0.1636  -0.2384   0.4026 1.0000     8839     5958
##
print(model_CAUDATEMulti_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh      0.0591    0.0484  -0.0361   0.1537 1.0006     9288     4375
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh   0.0825    0.1603  -0.2311   0.4074 1.0025     9195     4250

####
print(model_CAUDATEMulti_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh      0.0746    0.0570  -0.0372   0.1862 1.0008     5723     5442
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.1122    0.1651  -0.2095   0.4400 1.0003     7185     5131
save(model_CAUDATEMulti_hurdle_6, file = "model_CAUDATEMulti_hurdle_6.rda")

print(model_CAUDATEMulti_hurdle__Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh      0.0639    0.0567  -0.0466   0.1740 0.9999     7455     5830
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.1113    0.1637  -0.2101   0.4285 1.0002     8395     6019
###

print(model_CAUDATEMulti_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh      0.0680    0.0487  -0.0268   0.1623 0.9999     8129     5019
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.1109    0.1653  -0.2205   0.4354 1.0010     6786     4542
####

print(model_CAUDATEMulti_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh     -0.0647    0.0562  -0.1749   0.0433 1.0001     5108     5705
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh  -0.0204    0.1566  -0.3267   0.2885 1.0010     7430     5713
save(model_CAUDATEMulti_hurdle_7, file = "model_CAUDATEMulti_hurdle_7.rda")

print(model_CAUDATEMulti_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh     -0.0791    0.0541  -0.1831   0.0297 0.9999     8441     6230
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh  -0.0187    0.1536  -0.3145   0.2782 1.0006    10644     5602
####

print(model_CAUDATEMulti_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh     -0.0742    0.0485  -0.1692   0.0191 1.0031    13017     5708
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.lh  -0.0184    0.1564  -0.3322   0.2861 1.0009    11043     5648
####

print(model_CAUDATEMulti_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh     -0.0374    0.0561  -0.1486   0.0737 1.0004     7591     6049
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.0337    0.1618  -0.2827   0.3568 1.0007     9185     6031
save(model_CAUDATEMulti_hurdle_8, file = "model_CAUDATEMulti_hurdle_8.rda")


print(model_CAUDATEMulti_hurdle_8_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh     -0.0496    0.0542  -0.1573   0.0569 1.0013     6878     5839
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.0353    0.1603  -0.2806   0.3535 1.0008     8574     5928
####
print(model_CAUDATEMulti_hurdle_8_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh
                                            +(1|abcd_site/rel_family_id),
                                            hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                              neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                              tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh+(1|abcd_site/rel_family_id)),
                                         chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                         control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh     -0.0493    0.0488  -0.1446   0.0459 1.0004    16300     8110
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_caudate.rh   0.0345    0.1593  -0.2734   0.3488 1.0005    15383     7938
#####
#amygdala
print(model_AmygMulti_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh
                                      +(1|abcd_site/rel_family_id),
                                      hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh     -0.0047    0.0551  -0.1131   0.1027 1.0000     5044     5654
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh   0.1616    0.1521  -0.1301   0.4687 1.0006     7436     5432
meffects1 <- marginaleffects(model_Amyg_VG_brms1, vcov=FALSE)
plot1 <- plot_cme(model_Amyg_VG_brms1, effect="VGTotal_zero", condition="tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh")
save(model_AmygMulti_hurdle_1, file = "model_AmygMulti_hurdle_1.rda")

print(model_AmygMulti_hurdle_1_Win<- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh      0.0031    0.0528  -0.0998   0.1057 1.0001     7691     6360
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh   0.1643    0.1510  -0.1288   0.4612 1.0003     8001     5220

print(model_AmygMulti_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh     -0.0140    0.0481  -0.1087   0.0791 1.0006     7138     4870
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.lh   0.1622    0.1542  -0.1374   0.4700 1.0000     6363     5474
####
print(model_AmygMulti_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh
                                      +(1|abcd_site/rel_family_id),
                                      hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.99), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.1236    0.0542  -0.2289  -0.0180 1.0007     6983     7621
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh   0.2248    0.1551  -0.0742   0.5319 1.0002    10512     7004
save(model_AmygMulti_hurdle_2, file = "model_AmygMulti_hurdle_2.rda")

print(model_AmygMulti_hurdle_2_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.1159    0.0530  -0.2179  -0.0122 1.0005     7277     6157
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh   0.2221    0.1524  -0.0735   0.5230 1.0008     9622     6132
####

print(model_AmygMulti_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.1182    0.0481  -0.2116  -0.0260 1.0001    12183     6004
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_amygdala.rh   0.2263    0.1541  -0.0763   0.5305 1.0007    10746     5352
####

print(model_AmygMulti_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh
                                      +(1|abcd_site/rel_family_id),
                                      hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh     -0.0672    0.0514  -0.1661   0.0358 1.0002     6167     6428
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh   0.0635    0.1423  -0.2177   0.3425 1.0011     9905     7668
save(model_AmygMulti_hurdle_3, file = "model_AmygMulti_hurdle_3.rda")

print(model_AmygMulti_hurdle_3_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh     -0.0513    0.0504  -0.1504   0.0485 1.0002     4165     3396
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh   0.0593    0.1404  -0.2169   0.3308 1.0003     4398     3534
####

print(model_AmygMulti_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh     -0.0433    0.0469  -0.1353   0.0480 1.0002    13947     7309
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.lh   0.0629    0.1436  -0.2148   0.3512 1.0014    10979     7006
####

print(model_AmygMulti_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh
                                      +(1|abcd_site/rel_family_id),
                                      hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.1106    0.0553  -0.2194  -0.0025 0.9999    15790     9292
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh   0.1406    0.1504  -0.1523   0.4333 1.0003    21163     9374
save(model_AmygMulti_hurdle_4, file = "model_AmygMulti_hurdle_4.rda")


#
print(model_AmygMulti_hurdle_4_win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.0980    0.0534  -0.2028   0.0052 1.0004    21006    11488
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh   0.1405    0.1514  -0.1538   0.4398 1.0003    26618    10566
######

print(model_AmygMulti_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh     -0.0753    0.0474  -0.1701   0.0178 1.0000     6845     5220
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_amygdala.rh   0.1382    0.1522  -0.1514   0.4348 1.0001     5791     4764
####

print(model_AmygMulti_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                      +(1|abcd_site/rel_family_id),
                                      hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh      0.0628    0.0452  -0.0251   0.1540 1.0002     6542     6259
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh   0.0800    0.1295  -0.1697   0.3309 1.0002     7813     5636
save(model_AmygMulti_hurdle_5, file = "model_AmygMulti_hurdle_5.rda")

print(model_AmygMulti_hurdle_5_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                      +(1|abcd_site/rel_family_id),
                                      hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh      0.0588    0.0442  -0.0296   0.1443 1.0002     9993     6512
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh   0.0783    0.1276  -0.1700   0.3317 1.0000    10229     5818
save(model_AmygMulti_hurdle_5, file = "model_AmygMulti_hurdle_5.rda")

#####

print(model_AmygMulti_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh      0.0532    0.0394  -0.0245   0.1297 1.0000    16351     5751
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh   0.0794    0.1307  -0.1712   0.3403 1.0004    10841     6012

#
#########
print(model_AmygMulti_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                       +(1|abcd_site/rel_family_id),
                                       hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                         neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                         tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                    chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                    control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh      0.0650    0.0499  -0.0309   0.1632 1.0001     8449     6447
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh  -0.0153    0.1397  -0.2931   0.2557 1.0007    12093     5950



print(model_AmygMulti_hurdle_6_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh      0.0584    0.0489  -0.0362   0.1562 1.0001     6696     5833
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh  -0.0165    0.1355  -0.2769   0.2523 1.0000     8735     6113
########

print(model_AmygMulti_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh      0.0386    0.0453  -0.0514   0.1276 1.0020    20822     8600
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh  -0.0153    0.1390  -0.2820   0.2620 1.0001    16279     9280
#######
print(model_AmygMulti_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                      +(1|abcd_site/rel_family_id),
                                      hu~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh       -0.0181    0.0469  -0.1083   0.0777 1.0007     7461     6350
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh  -0.0157    0.1329  -0.2741   0.2461 1.0001     8525     5355
save(model_AmygMulti_hurdle_7, file = "model_AmygMulti_hurdle_7.rda")

print(model_AmygMulti_hurdle_7_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh     -0.0165    0.0458  -0.1081   0.0753 1.0011     8167     6331
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh  -0.0006    0.1385  -0.2792   0.2750 1.0005     8679     5451
####

print(model_AmygMulti_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh
                                         +(1|abcd_site/rel_family_id),
                                         hu~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh     -0.0037    0.0408  -0.0823   0.0781 0.9999    28376     8387
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.lh   0.0001    0.1368  -0.2700   0.2647 1.0001    21389     9059
###

print(model_AmygMulti_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                      +(1|abcd_site/rel_family_id),
                                      hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                        neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                        tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                   chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                   control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh     -0.0836    0.0484  -0.1795   0.0094 1.0004     6982     6127
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh  -0.1714    0.1239  -0.4191   0.0641 1.0001     7040     4497
save(model_AmygMulti_hurdle_8, file = "model_AmygMulti_hurdle_8.rda")

print(model_AmygMulti_hurdle_8_Win <- brm(bf(TotalGaming_FrequencyMulti_Minutes_Win1 ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=4000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh     -0.0900    0.0465  -0.1801   0.0009 1.0008    10444     9089
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh  -0.1697    0.1213  -0.4190   0.0583 1.0003    10581     8583

print(model_AmygMulti_hurdle_8_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh
                                         +(1|abcd_site/rel_family_id),
                                         hu ~ sex+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                           neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                           tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh+(1|abcd_site/rel_family_id)),
                                      chains=4, cores=4, warmup=1000, iter=3000, family = hurdle_negbinomial(), 
                                      control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh     -0.0769    0.0418  -0.1591   0.0033 1.0008    12017     5765
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_amygdala.rh  -0.1706    0.1221  -0.4182   0.0645 1.0008     8164     5126
#####
summary(model_PM_Multi_hurdle_1 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x+(1|abcd_site/rel_family_id),
                                          hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x     -0.1615    0.0728  -0.3065  -0.0201 1.0002     7458     7549
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x   0.1924    0.2011  -0.2164   0.5794 1.0001    10880     7757

summary(model_PM_Multi_hurdle_1_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x+(1|abcd_site/rel_family_id),
                                          hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x     -0.1222    0.0642  -0.2470   0.0040 1.0007     7570     4117
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.lh.x   0.1922    0.2033  -0.1950   0.6055 1.0006    11085     6031
####
summary(model_PM_Multi_hurdle_2 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x+(1|abcd_site/rel_family_id),
                                          hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
print(model_PM_Multi_hurdle_2, digits=4)
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x   0.2555    0.1974  -0.1296   0.6473 1.0006     9569     6719
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x     -0.1328    0.0713  -0.2743   0.0070 1.0002     7145     7263

print(model_PM_Multi_hurdle_2_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x+(1|abcd_site/rel_family_id),
                                          hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x     -0.1073    0.0621  -0.2319   0.0143 1.0001    11681     6978
#hu_tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_putamen.rh.x   0.2553    0.1961  -0.1257   0.6425 1.0004    10221     7165
####
summary(model_PM_Multi_hurdle_3 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                          hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
print(model_PM_Multi_hurdle_3, digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh     -0.1023    0.0719  -0.2455   0.0385 1.0009     7327     7682
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh   0.2742    0.2089  -0.1277   0.6840 1.0005    11366     7586

summary(model_PM_Multi_hurdle_3_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                          hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                            neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                            tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                       chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                       control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh     -0.0668    0.0629  -0.1891   0.0569 1.0007    13426     7437
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.lh   0.2766    0.2069  -0.1267   0.6769 1.0013    10397     7384
#####

print(model_PM_Multi_hurdle_4 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh     -0.0830    0.0738  -0.2282   0.0609 1.0014     7468     7515
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh   0.2979    0.2047  -0.0975   0.7026 1.0008    10095     7046

print(model_PM_Multi_hurdle_4_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh     -0.0532    0.0642  -0.1795   0.0732 1.0017    10209     4452
#hu_tfmri_mid_all_antic.large.loss.vs.neutral_beta_subcort.aseg_putamen.rh   0.3004    0.2075  -0.1008   0.7135 1.0002     9989     6572
#####
print(model_PM_Multi_hurdle_5 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh      0.0576    0.0635  -0.0690   0.1815 1.0005     7294     7353
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh   0.1725    0.1871  -0.1953   0.5394 1.0003    10834     6992

print(model_PM_Multi_hurdle_5_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh      0.0496    0.0553  -0.0579   0.1580 1.0002    13414     7523
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh   0.1784    0.1885  -0.1901   0.5502 1.0005    11246     7588
#####

print(model_PM_Multi_hurdle_6 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh      0.0558    0.0651  -0.0719   0.1826 1.0004     6976     7115
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh   0.0843    0.1961  -0.3058   0.4715 1.0009     8881     6289

print(model_PM_Multi_hurdle_6_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh      0.0437    0.0583  -0.0712   0.1584 1.0002     7889     4435
#hu_tfmri_mid_all_reward.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh   0.0898    0.2016  -0.3025   0.4836 1.0008     5567     3523
#####
print(model_PM_Multi_hurdle_7 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)

#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh     -0.0215    0.0210  -0.0632   0.0191 1.0003     4880     6358
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh  -0.1930    0.3015  -0.7936   0.3886 1.0005     7686     7292

print(model_PM_Multi_hurdle_7_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh     -0.0443    0.0578  -0.1557   0.0722 1.0059      936      409
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.lh  -0.0715    0.1786  -0.4221   0.2720 1.0006     4267     3288
#####
print(model_PM_Multi_hurdle_8 <- brm(bf(TotalGaming_FrequencyMulti_Minutes ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=3000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.80), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh     -0.0150    0.0214  -0.0580   0.0264 1.0005     5021     6492
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh  -0.4115    0.3120  -1.0260   0.2005 1.0010     7387     7389


########

print(model_PM_Multi_hurdle_8_MAD <- brm(bf(TotalGaming_FrequencyMulti_Minutes_MAD ~ 1+sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id),
                                        hu ~ sex+  interview_age_scaled+race_ethnicity+high.educ.bl+hh_combined+married.bl+
                                          neighborhood_crime_y+pmq_y_ss_mean_scaled+ CBCLAttention_Final_scaled +
                                          tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh+(1|abcd_site/rel_family_id)),
                                     chains=4, cores=4, warmup=500, iter=4000, family = hurdle_negbinomial(), 
                                     control=list(adapt_delta=0.90), seed=1234, backend="cmdstanr", threads = threading(8), data=ABCD_GamingYear2_QC), digits=4)
#tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh     -0.1153    0.0555  -0.2237  -0.0068 1.0002    31686    10082
#hu_tfmri_mid_all_loss.pos.vs.neg.feedback_beta_subcort.aseg_putamen.rh  -0.0490    0.1874  -0.4203   0.3194 1.0006    24846    10636

######################

 
##############
#everything below is just used to create tables S2 and S3.
##############
library(tableone)
library(dplyr)
Visit2 <- Visit2_full[,c("src_subject_id", "eventname", "sex", "high.educ.bl", "married.bl", 
                        "abcd_site","household.income.bl", "tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh", "screentime_vgaq6",
                        "demo_comb_income_p_l")]

Visit2<- Visit2 %>% 
  mutate(visit = case_when(
    eventname == "baseline_year_1_arm_1" ~ 1,
    eventname == "1_year_follow_up_y_arm_1" ~ 2,
    eventname == "2_year_follow_up_y_arm_1" ~3)) 

Visit2 <- Visit2[,c("src_subject_id", "visit", "sex",  "high.educ.bl", "married.bl", 
                    "abcd_site","household.income.bl", "tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh", "screentime_vgaq6", "demo_comb_income_p_l")]

Merge_Visit2 <- ABCD_TBI[,c("src_subject_id", "visit", "interview_age", "race_ethnicity", "pmq_y_ss_mean", "neighborhood_crime_y")]


Visit2_all_ppts<-  merge(Visit2, Merge_Visit2,
                   all.x =TRUE, by=c("visit", "src_subject_id"))
saveRDS(Visit2_all_ppts, "Visit2_all_ppts.RDS")

Visit2_all_ppts<- Visit2_all_ppts%>% 
  mutate(MRI_missing = case_when(
    (tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh < 10)    ~ "not missing",  
    TRUE ~ "missing"))
table(Visit2_all_ppts$MRI_missing)


Visit2_all_ppts<- Visit2_all_ppts%>% 
  mutate(gaming_missing = case_when(
    screentime_vgaq6 == "Never"    ~ "not missing",  
    screentime_vgaq6 == "Very rarely"    ~ "not missing",
    screentime_vgaq6 == "Rarely"    ~ "not missing",
    screentime_vgaq6 == "Sometimes"    ~ "not missing",
    screentime_vgaq6 == "Often"    ~ "not missing",
    screentime_vgaq6 == "Very often"    ~ "not missing",
     screentime_vgaq6 == "Refuse to answer"    ~ "missing", 
    TRUE ~ "missing"))
table(Visit2_all_ppts$gaming_missing)
# missing not missing 
# 2836        7578 


Visit2_all_ppts<- Visit2_all_ppts%>% 
  mutate(missing_any = case_when(
    MRI_missing == "missing" | gaming_missing == "missing"    ~ "missing",  
    TRUE ~ " not missing"))
table(Visit2_all_ppts$missing_any)
# not missing      missing 
# 5094         5320

##############################
Visit2_all_ppts %>% 
  group_by(missing_any) %>% 
  summarize(mean = mean(interview_age, na.rm=TRUE),
            #         summarize(median = median(pps_y_ss_severity_score, na.rm=TRUE),
            (sd=sd(interview_age, na.rm=TRUE)))

Visit2_all_ppts<- Visit2_all_ppts%>% 
  mutate(HHIncome = case_when(
    demo_comb_income_p_l == 1 ~ "<50K",
    demo_comb_income_p_l == 2 ~ "<50K",
    demo_comb_income_p_l == 3 ~ "<50K",
    demo_comb_income_p_l == 4 ~ "<50K",
    demo_comb_income_p_l == 5 ~ "<50K",
    demo_comb_income_p_l == 6 ~ "<50K",
    demo_comb_income_p_l == 7 ~ ">=50K & <100K",
    demo_comb_income_p_l == 8 ~ ">=50K & <100K",
    demo_comb_income_p_l == 9 ~ "100K & <200k",
    demo_comb_income_p_l == 10 ~ ">=200K",
    demo_comb_income_p_l == 999 ~ "Do not know",
    demo_comb_income_p_l == 777 ~ "Refuse to answer"))

##############################

library(tableone)

myVars <- c("visit", "sex", "high.educ.bl", "interview_age", "married.bl", "race_ethnicity", "pmq_y_ss_mean", "MRI_missing", "gaming_missing", "missing_any",
          "neighborhood_crime_y",  "abcd_site","household.income.bl", "tfmri_mid_all_antic.large.reward.vs.neutral_beta_subcort.aseg_accumbens.area.lh", "screentime_vgaq6", "HHIncome")

catVars <- c("visit", "sex", "high.educ.bl",  "married.bl", "race_ethnicity","MRI_missing", "gaming_missing", "missing_any",
             "neighborhood_crime_y",  "abcd_site","household.income.bl", "HHIncome")

tab2 <- CreateTableOne(vars=myVars, data=Visit2_all_ppts, factorVars=catVars)
tab2

#this will show all levels 
print(tab2, showAllLevels = TRUE, formatOptions = list(big.mark = ","))

#this will show missingness
tab3 <- CreateTableOne(vars=myVars, strata=c("gaming_missing"), data=Visit2_all_ppts, factorVars=catVars)
summary(tab3)
tab3Mat <- print(tab3, showAllLevels=TRUE,quote=FALSE, noSpaces=TRUE, printToggle=FALSE, includeNA=TRUE)

write.csv(tab3Mat, file="Missing_gaming.csv")
tab3Mat
###########
library(ggplot2)
xx <- ABCD_GamingYear2_QC[,c("VGTotal_zero")]
ggplot(ABCD_GamingYear2_QC, aes(VGTotal_zero, na.rm=TRUE)) + 
  geom_histogram()

ggplot(data=subset(ABCD_GamingYear2_QC, !is.na(VGTotal_zero)), aes(x=VGTotal_zero)) + 
  geom_histogram(bins=30, color = "#000000", fill = "#0099F8")+
  labs(
    #title = "Histogram of Video Game Addiction Questionnaire",
    x = "VGAQ Score",
    y = "Count"
  ) +
  theme_classic()

TotalGaming_FrequencyMulti_Minutes

ggplot(data=subset(ABCD_GamingYear2_QC, !is.na(TotalGaming_FrequencyMulti_Minutes)), aes(x=TotalGaming_FrequencyMulti_Minutes)) + 
  geom_histogram(bins=30, color = "#000000", fill = "#0099F8")+
  labs(
    #title = "Histogram of Online Gaming Frequency",
    x = "Online Gaming Frequency (minutes per week)",
    y = "Count"
  ) +
  theme_classic()
